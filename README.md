# プログラミング学習記録　2025/12/15（月）

## 昨日やったこと
- PHP基礎学習（正規表現）
 
## 今日やること
- PHP基礎学習（正規表現続き）
- 
## 明日やること
- PHP基礎学習（正規表現続き）


## メモ
- 正規定数とは、文字列の共通のパターンやルールを持つ複数の文字列一つの文字列で表現する方法のこと
- 正規定数が使える代表的なPHP関数(組み込み関数)
```
// 最初に一致した文字列を取得する
preg_match(正規表現,検索対象,検索結果を代入する配列);
※第３引数の「検索結果を代入する配列」はオプションなので渡さなくてもOK。

// 一致した文字列を全て取得する
preg_match_all(正規表現,検索対象,検索結果を代入する配列);

// 一致した文字列を他の文字列に置き換える
preg_replace(正規表現パターン,置換する新しい文字列,対象の文字列[,最大置換回数[, カウント変数]]);

// 配列に対して正規定数による検索を行い、一致した要素を配列で返す
preg_greg(正規表現,検索対象);
```
- 正規表現は慣習的に/（スラッシュ）で囲む。
- 部分一致は検索したい文字列を/（スラッシュ）で囲む
- 前方一致は検索したい文字列の直前に^（ハット）をつける
- 後方一致は検索したい文字列の直後に$（ドル）をつける
- 完全一致は検索したい文字列を\Aと\zで囲む
- 特定の文字列ではなく、任意の1文字を正規表現で検索する方法
```
// 小文字のアルファベットが含まれているかどうか正規表現で検索する
if (preg_match('/[a-z]/', 検索対象) {
 echo 〇〇〇〇;
} else{
 echo □□□□;
}
```
```
// 数字が含まれているかどうか正規表現で検索する
if (preg_match('/[0-9]/', 検索対象)) {
 echo 〇〇〇〇;
} else{
 echo □□□□;
}
```
```
// 英数字が含まれているか正規表現で検索する
if (preg_match('/[a-zA-Z0-9]')) {
 echo 〇〇〇〇;
} else{
 echo □□□□;
]
```
**正規表現の主な記号**

①+（１回以上）
直前の文字やパターンが1回以上繰り返す。ないとマッチしない。
例：a+ → 「a」「aa」「aaa」など

②＊（0回以上）
直前が0回でもOK、何回でもOK
例：ab* は次に一致 →「a(bが0個)」「ab(bが1個)」「abbbbbb(bが複数)」

③?（0回または1回）
あってもなくてもいい
例：colou?r → 両方に一致する「color」「colour」

④{n}（n回ちょうど）
直前がちょうどn回
例：a{3} → 「aaa」に一致

⑤{n,} （n回以上）
最低n回以上なら何回でも
例：a{2,} → 「aa」「aaa」「aaaaa」など一致

⑥{n,m}（n〜m回）
最低n回、最大m回の範囲。
例：a{2,4} → 「aa」「aaa」「aaaa」に一致。

⑦[]（文字の集合）
[abc] → a,b,cのどれか
[0-9] → 数字
[a-zA-Z] → 英字全般

⑧[^]（否定）
角括弧の中で^が最初に来ると「それ以外」。
例：[^0-9] → 数字以外に一致

⑨^ （行頭）
行の先頭にマッチ。
例：^Hello → 「Hello」で始まる行だけマッチ

⑩$ (行末）
行の終わりに一致
例：world$ → 「world」で終わる行に一致

.（何でも1文字）
改行以外なら何でもOK。
例：a.b → “acb”,”a0b”,”a-b”など

**メールアドレスのフォーマットチェック**
- 使える文字は英数字または「.（ドット）」のみ
-「○○○@□□□」のように、間に「@（アットマーク）」が入る
- ユーザー名（@の左側）とドメイン名（@の右側）はそれぞれ1文字以上

```php
if (preg_match_all(/\[a-zA-Z0-9.]+@[a-zA-Z0-9.]+\z/, $email)) {

echo ‘正規表現に一致しました。’

} else {

echo ‘正規表現に一致しませんでした。’

}
```

**携帯電話番号のフォーマットチェック**
- 先頭が「070」「080」「090」のいずれかで始まる
- 「○○○-●●●●-■■■■」のように「-（ハイフン）」で区切る
- 3桁、4桁、4桁の計11桁にする

```php
<h2>
    <?php
    $mobile = '090-0000-0000';

    echo '検索対象：' . $mobile;
    ?>
</h2>
<p>
    <?php
    echo '携帯電話番号のフォーマットと完全に一致しているかどうかを正規表現で検索します。<br>';

    if (preg_match_all('/\A0[7-9]0-[0-9]{4}-[0-9]{4}\z/', $mobile)) {
        echo '>正規表現に一致しました。';
    } else {
        echo '>正規表現に一致しませんでした。';
    }
    ?>
</p>
```
- （）グループ化
  例：(○○○)-(●●●●)-(■■■■)＝$1-$2-$3
  
**date()関数**
- date()関数は特定のフォーマットで日時の文字列を返す関数です。
第2引数（UNIXタイムスタンプ）はオプションなので省略可能。
```
date(日時のフォーマット,UNIXタイムスタンプ）
```
- 日時のフォーマット文字
日時のフォーマットを指定するには「Y」や「n」など特殊なフォーマット文字を使います。
日本の日時を取得するために、date_default_timezone_set()関数を使ってタイムゾーンを指定します。
```
// 使用するデフォルトのタイムゾーンを指定する
date_default_timezone_set('Asia/Tokyo');

// 現在の日時を指定したフォーマットで出力する
echo date('Y年n月j日H時i分s秒') . '<br>';
```

- **date()関数を使って、現在の日時以外を取得する場合、UNIXスタンプを第2引数として渡す必要がある。**
- UNIXスタンプとは、1970年1月1日からの経過秒数のこと。(例えば「1426690800」「1652662122」など)
- UNIXスタンプを取得するには、strtotime()関数を使う
```
strtotime(日時,基準となるUNIXスタンプ）
```
第2引数はオプションなので省略可能です。
第1引数の日時には、絶対日時（19 march 2015等）だけでなく相対日時（'+1 days'等）を指定できる。
```
date('Y/m/d H:i:s', strtotime('-3 years'));
```
